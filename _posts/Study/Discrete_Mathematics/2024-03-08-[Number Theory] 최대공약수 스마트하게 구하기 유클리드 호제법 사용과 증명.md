---
title: "[Number Theory] 최대공약수 스마트하게 구하기 유클리드 호제법 사용과 증명"
author: baduk
date: 2024-03-08 11:42:00 +0900
categories: [Study, Discrete Mathematics]
tags: [Discrete Mathematics]
---
## 간단한 방법으로 최대공약수 구하기
대부분의 사람들은 어릴적 수학시간에 두 수의 최대공약수를 구하는 문제를 풀어봤을 것이다.

예를들어 4와 6의 최대공약수를 구하라고 하면 이를 해결하기위한 간단한 방법은 아래와 같다.
```
1.4의 약수를 나열한다.
-> 1, 2, 4

2.6의 약수를 나열한다.
-> 1, 2, 3, 6

3.두 나열된 수중 가장 큰 수를 찾는다.
정답 : 2
```
이런식으로 최대공약수를 구할 수 있다.

하지만 2304, 1440의 최대공약수를 구하라와 같은 문제 처럼 수가 매우 크다면 이와 같은 방법을 사용하는 것은 매우 힘들고 비효율적일 것이다.
이때 최대공약수를 구하는 좋은 방법은 유클리드 호제법을 사용하는 것이다.

## 스마트하게 최대공약수 구하기(유클리드 호제법)

유클리드 호제법의 시작은 a가 b보다 큰 수라고 가정할때, a와 b의 최대공약수와 a를 b로 나눈 나머지와 b의 최대공약수가 같다는 것에서 시작된다.(ex. GCD(a,b) = GCD(b,a%b))

일단 유클리드 호제법을 증명하기에 앞서, 유클리드 호제법을 사용하여 2304, 1440의 최대공약수를 구해보겠다. 과정은 아래와 같다.

```
GCD(2304, 1440)
= GCD(1440, 864(=2304%1440))
= GCD(864, 576(=1449%864))
= GCD(576, 288(=864%576))
= GCD(288, 1(=576%288))
```
위와 같이 두 수의 나머지를 구하다가 1이 나오면 더 이상 1로 나머지를 구해도 수의 변화가 없어지므로 그만두고, 1이 아닌 또 다른 수가 최대공약수가 된다. 계산 과정이 짧아서 어릴적에 풀었던 방식보다 훨씬 효율적이다.


## 유클리드 호제법 증명
그럼 이제 궁금한것이 왜 GCD(2304, 1440)와 GCD(1440, 864(=2304%1440))가 같냐라는 것이다. 

A가 B보다 크다고 가정 했을때, GCD(A,B) = GCD(B,A%B) 임을 증명해보겠다. (그리고 GCD(첫번째 수,두번째 수)가 있을 때 첫번째 수에는 큰 수를 넣고 두번째 수에는 작은 수를 넣으면서 진행하겠다.)

우선 GCD(A,B)는 = K라고 해보자 여기서 K는 A와 B의 최대공약수다. 그리고 A를 B로 나눈 나머지 A%B는 R이라고 하고(A%B=R), A를 B로 나눈 몫을 Q라고 하겠다(A//B=Q)

그럼 A를 다른 방식으로 표현하자면 A = Q * B + R 로 표현할 수 있다. 또한 A와 B를 최대 공약수인 K를 가지고 표현하자면 A = K * M, B = K * N 이라고 할 수 있다. K는 A,B의 최대공약수라면 여기서 `M과 N은 반드시 서로소관계`여야 한다. 이거 계속 기억하고 있어야 한다. 유클리드 호제법 증명에서 아주 중요한 부분이기 때문이다!

따라서 A = Q * B + R 이 식에 A(=K * M)와 B(=K * N)를 각각 대입하여 나타내면, K * M = Q*(K * N) + R 로 나타낼 있다. 여기서 나머지인 R은 아래와 같이 표현될 수 있다.

```
R = K*M - Q*(K*N)
즉,
R = (M - Q*N)*K
```
위 수식에서 R로 표현할 때 K라는 곱해주는 수가 있다. 위에서 B = K * N이라고 하였다. 즉 K는 B와 R의 공약수임은 틀림없어졌다. 하지만 우리가 확고히 해야하는 것은 K가 최대 공약수냐 아니냐 라는 것이다.

아직까지는 K가 최대공약수인 것은 알 수 없다. 왜냐하면 K앞에 붙어있는 (M - Q * N)과 M이 서로소임이 증명이 안됐기 때문이다. 만약 (M - Q*N)과 N이 서로소라면 K는 비로소 B와 R의 최대공약수가 된다.

(M - Q * N)과 N이 서로소임을 어떻게 증명할 수 있을까? 이때 증명방법으로 귀류법을 사용한다. 귀류법은 간단히 말해서 반대를 가정해서 모순이 발생하면, 그 반대가 틀렸다라는 식으로 증명을 한다.

따라서 (M - Q * N)과 N이 서로소가 아님을 가정해보자. 만약 이 가정에 모순이 생긴다면 (M - Q * N)과 N이 서로소 인것이고, K는 B와 R의 최대공약수임이 증명되는 것이다.

```
N = xG
M - Q * N = yG
```
위 식과 같이 N과 (M - Q * N)이 서로소 가 아니어서, 공통된 약수 G가 있다고 해보자. 위 식 첫 번째에 있는 N(=xG)을 아래 두번째 식에 대입하면 아래와 같이 표현될 수 있다.

```
M - Q * xG = yG

좌변에 M만 남기고 나머지를 우변으로 넘기면 아래와 같고
M = yG + Q * xG

우변을 G로 묶어주면 아래와 같다
M = (y + Q * x)G
```

증명이 끝났다. M은 G로 묶일 수 있다. 즉, G는 M의 약수다. 하지만 위에서 N = xG라고 하였다. 여기서 모순이 발생한다. 아까 위에서 M과 N은 반드시 서로소관계여야 한다고 했다. 하지만 여기서 N = xG이고 M = (y + Q * x)G 라면 G라는 공약수가 발생한다. 따라서 애초에 N과 (M - Q * N)이 서로소가 아님을 가정했을 때 모순이 발생하였고 N과 (M - Q * N)은 서로소가 맞다고 증명이된다.

따라서 결론적으로 K는 A와 B의 최대공약수이면서, B와 R(A를 B로 나눈 나머지)의 최대공약수다.