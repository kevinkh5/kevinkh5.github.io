---
title: '[SELECT] SQL Select 연습'
author: baduk
date: 2024-02-04 16:24:00 +0900
categories: [Study, SQL]
tags: [SQL]
---

## 카운트로 평균구하기
ROUND(SUM(DAILY_FEE) / COUNT(DAILY_FEE),0)
```sql
SELECT ROUND(SUM(DAILY_FEE) / COUNT(DAILY_FEE),0)
FROM CAR_RENTAL_COMPANY_CAR
WHERE CAR_TYPE = "SUV"
```

## AVG로 평균 구하기
ROUND(AVG(DAILY_FEE),0)
```sql
SELECT ROUND(AVG(DAILY_FEE),0)
FROM CAR_RENTAL_COMPANY_CAR
WHERE CAR_TYPE = "SUV"
```

## 특정 연도 검색하기
연도 포맷팅한 후 출력하기
DATE_FORMAT(PUBLISHED_DATE, '%Y-%m-%d')
```sql
SELECT BOOK_ID, DATE_FORMAT(PUBLISHED_DATE, '%Y-%m-%d')
FROM BOOK
WHERE CATEGORY = '인문' AND YEAR(PUBLISHED_DATE) = 2021
ORDER BY PUBLISHED_DATE;
```


## null값 "NONE"으로 출력하기
SELECT ~ IFNULL(TLNO,'NONE')
```sql
SELECT PT_NAME, PT_NO, GEND_CD, AGE, IFNULL(TLNO,'NONE')
FROM PATIENT
WHERE (AGE<=12) AND (GEND_CD='w')
ORDER BY AGE DESC, PT_NAME ASC
```
셀렉트 순서도 맞춰야한다. 달라지면 틀린다.


## 널값은 제외하고 출력하기
WHERE ~ IS NOT NULL
```sql
SELECT MEMBER_ID, MEMBER_NAME, GENDER, DATE_FORMAT(DATE_OF_BIRTH, '%Y-%m-%d') AS DATE_OF_BIRTH
FROM MEMBER_PROFILE
WHERE MONTH(DATE_OF_BIRTH) = 3 AND GENDER = 'W' AND TLNO IS NOT NULL
ORDER BY MEMBER_ID
```
날짜 데이트 포매팅할 때 Y무조건 대문자여야함. 데이트 포맷 할 때 대소문자 주의, 대문자냐 소문자냐에 따라 달라짐

## 필드값이 특정 값을 포함한다는 조건 걸때
WHERE ~ IN ('~',  '~')
```sql
SELECT DR_NAME, DR_ID, MCDP_CD, DATE_FORMAT(hIRE_YMd,'%Y-%m-%d')
FROM doctor
WHERE MCDP_CD IN ('CS','GS')
ORDER BY HIRE_YMD DESC, DR_NAME ASC
```

## 두 테이블 연결시키기
이너조인 서로 공통된것만 조회

1.WHERE로 쓰기
WHERE A = B
```sql
SELECT b.TITLE, b.BOARD_ID, r.REPLY_ID,r.WRITER_ID,r.CONTENTS, DATE_FORMAT(r.CREATED_DATE,'%Y-%m-%d')
FROM USED_GOODS_BOARD b, USED_GOODS_REPLY r
WHERE b.BOARD_ID = r.BOARD_ID
AND YEAR(b.CREATED_DATE)=2022 and MONTH(b.CREATED_DATE)=10
ORDER BY r.CERATED_DATE ASC, b.TITLE ASC
```

2.이너조인으로 쓰기
INNER JOIN ~ ON A = B
```sql
SELECT b.TITLE, b.BOARD_ID, r.REPLY_ID,r.WRITER_ID,r.CONTENTS, DATE_FORMAT(r.CREATED_DATE,'%Y-%m-%d')
FROM USED_GOODS_BOARD b
INNER JOIN USED_GOODS_REPLY r ON b.BOARD_ID = r.BOARD_ID
WHERE YEAR(b.CREATED_DATE)=2022 AND MONTH(b.CREATED_DATE)=10
ORDER BY r.CREATED_DATE ASC, b.TITLE ASC
```

## 포함된 값 검색하기
포함된 값
WHERE ~ LIKE '~%'
```sql
SELECT FACTORY_ID, FACTORY_NAME, ADDRESS
FROM FOOD_FACTORY F
WHERE F.ADDRESS LIKE '%강원도%'
ORDER BY F.FACTORY_ID ASC
```

## WHERE 에서 NOT 쓰기
WHERE ~ != '~'
```sql
SELECT A.ANIMAL_ID, A.NAME
FROM ANIMAL_INS A
WHERE A.INTAKE_CONDITION != 'Aged'
ORDER BY A.ANIMAL_ID
```

## 데이터 하나만 뽑고싶을때
LIMIT
상위 N개 뽑기
```sql
SELECT A.NAME
FROM ANIMAL_INS A
ORDER BY A.DATETIME ASC
LIMIT 1
```

## 데이터 개수 셀때
SELECT COUNT(*)
```sql
SELECT COUNT(*) AS USERS
FROM USER_INFO U
WHERE YEAR(U.JOINED)=2021
AND AGE>=20 AND AGE<=29
```

## 필드 값 종류를 유니크하게 조회하고싶을땐
GROUP BY
```sql
SELECT O.USER_ID, O.PRODUCT_ID
FROM ONLINE_SALE O
GROUP BY PRODUCT_ID, USER_ID
HAVING COUNT(*) > 1
ORDER BY O.USER_ID ASC, O.PRODUCT_ID DESC
```

```sql
SELECT 도시, 고객ID, COUNT(*) AS 주문횟수
FROM 주문
GROUP BY 1, 2;
```
위 쿼리에서 GROUP BY 1, 2는 도시와 고객ID 열을 기준으로 그룹화하겠다는 의미. 여기서 1은 SELECT 문에서 첫 번째로 나오는 열인 도시, 2는 두 번째로 나오는 열인 고객ID를 나타냄.

## sql 절 순서

```sql
SELECT

FROM 테이블1
INNER JOIN 테이블2 ON 테이블1.필드 = 테이블2.필드

WHERE

GROUP BY
HAVING 필드 LIKE '텍스트%'

ORDER BY

LIMIT
```
붙어있는 절은 같이 쓰여서 붙여놓음 (FROM - INNER JOIN , GROUP BY - HAVING)

WHERE랑 HAVING 차이는 일단 WHERE는 개별 행만 필터링 하고, HAVING은 그룹화된 데이터를 필터링함.
가능한 효율적인 WHERE를 쓰는게 좋다고 함

## 두 테이블 합칠 땐 UNION ALL
UNION ALL
```sql
-- 코드를 입력하세요
SELECT DATE_FORMAT(N.SALES_DATE,'%Y-%m-%d') AS SALES_DATE, N.PRODUCT_ID, N.USER_ID, N.SALES_AMOUNT
FROM ONLINE_SALE N
WHERE YEAR(N.SALES_DATE) = 2022 AND MONTH(N.SALES_DATE) = 3
UNION ALL
SELECT DATE_FORMAT(F.SALES_DATE,'%Y-%m-%d'), F.PRODUCT_ID, NULL AS USER_ID, F.SALES_AMOUNT
FROM OFFLINE_SALE F
WHERE YEAR(F.SALES_DATE) = 2022 AND MONTH(F.SALES_DATE) = 3
ORDER BY SALES_DATE ASC, PRODUCT_ID ASC, USER_ID ASC
```